let note1 = "ra",
  note2 = "soft-ga",
  note3 = "ga",
  note4 = "ma",
  note5 = "sharp-ma",
  note6 = "pa",
  note7 = "soft-dha",
  note8 = "dha",
  note9 = "soft-ni",
  note10 = "ni",
  note11 = "sa",
  note12 = "soft-ra";

let keyFlow = [
  [
    {
      [note1]: "",
    },

    {
      [note2]: "",
    },
    {
      [note3]: "",
    },
    {
      [note4]: "",
    },
    {
      [note5]: "a",
    },
    {
      [note6]: "q",
    },
    {
      [note7]: "w",
    },
    {
      [note8]: "s",
    },
    {
      [note9]: "e",
    },
    {
      [note10]: "d",
    },
    {
      [note11]: "r",
    },
    {
      [note12]: "f",
    },
  ],

  [
    {
      [note1]: "g",
    },
    {
      [note2]: "t",
    },
    {
      [note3]: "h",
    },
    {
      [note4]: "y",
    },
    {
      [note5]: "j",
    },
    {
      [note6]: "u",
    },
    {
      [note7]: "i",
    },
    {
      [note8]: "k",
    },
    {
      [note9]: "o",
    },
    {
      [note10]: "l",
    },
    {
      [note11]: "p",
    },
    {
      [note12]: ";",
    },
  ],
  [
    {
      [note1]: "'",
    },
    {
      [note2]: "[",
    },
    {
      [note3]: "Enter",
    },
    {
      [note4]: "]",
    },
    {
      [note5]: "",
    },
    {
      [note6]: "",
    },
    {
      [note7]: "",
    },
    {
      [note8]: "",
    },
    {
      [note9]: "",
    },
    {
      [note10]: "",
    },
    {
      [note11]: "",
    },
    {
      [note12]: "",
    },
  ],
];

let configNote = [
  {
    cord_1: [
      {
        note: note1,
        sound: "c1ra",
      },
      {
        note: note2,
        sound: "c1sga",
      },
      {
        note: note3,
        sound: "c1ga",
      },
      {
        note: note4,
        sound: "c1ma",
      },
      {
        note: note5,
        sound: "c1sma",
      },
      {
        note: note6,
        sound: "c1pa",
      },
      {
        note: note7,
        sound: "c1sdha",
      },
      {
        note: note8,
        sound: "c1dha",
      },
      {
        note: note9,
        sound: "c1sni",
      },
      {
        note: note10,
        sound: "c1ni",
      },
      {
        note: note11,
        sound: "c1sa",
      },
      {
        note: note12,
        sound: "c1sra",
      },
    ],
  },
  {
    cord_2: [
      {
        note: note1,
        sound: "c2ra",
      },
      {
        note: note2,
        sound: "c2sga",
      },
      {
        note: note3,
        sound: "c2ga",
      },
      {
        note: note4,
        sound: "c2ma",
      },
      {
        note: note5,
        sound: "c2sma",
      },
      {
        note: note6,
        sound: "c2pa",
      },
      {
        note: note7,
        sound: "c2sdha",
      },
      {
        note: note8,
        sound: "c2dha",
      },
      {
        note: note9,
        sound: "c2sni",
      },
      {
        note: note10,
        sound: "c2ni",
      },
      {
        note: note11,
        sound: "c2sa",
      },
      {
        note: note12,
        sound: "c2sra",
      },
    ],
  },
  {
    cord_3: [
      {
        note: note1,
        sound: "c3ra",
      },
      {
        note: note2,
        sound: "c3sga",
      },
      {
        note: note3,
        sound: "c3ga",
      },
      {
        note: note4,
        sound: "c3ma",
      },
      {
        note: note5,
        sound: "c3sma",
      },
      {
        note: note6,
        sound: "c3pa",
      },
      {
        note: note7,
        sound: "c3sdha",
      },
      {
        note: note8,
        sound: "c3dha",
      },
      {
        note: note9,
        sound: "c3sni",
      },
      {
        note: note10,
        sound: "c3ni",
      },
      {
        note: note11,
        sound: "c3sa",
      },
      {
        note: note12,
        sound: "c3sra",
      },
    ],
  },
  {
    cord_4: [
      {
        note: note1,
        sound: "c4ra",
      },
      {
        note: note2,
        sound: "c4sga",
      },
      {
        note: note3,
        sound: "c4ga",
      },
      {
        note: note4,
        sound: "c4ma",
      },
      {
        note: note5,
        sound: "c4sma",
      },
      {
        note: note6,
        sound: "c4pa",
      },
      {
        note: note7,
        sound: "c4sdha",
      },
      {
        note: note8,
        sound: "c4dha",
      },
      {
        note: note9,
        sound: "c4sni",
      },
      {
        note: note10,
        sound: "c4ni",
      },
      {
        note: note11,
        sound: "c4sa",
      },
      {
        note: note12,
        sound: "c4sra",
      },
    ],
  },
  {
    cord_5: [
      {
        note: note1,
        sound: "c5ra",
      },
      {
        note: note2,
        sound: "c5sga",
      },
      {
        note: note3,
        sound: "c5ga",
      },
      {
        note: note4,
        sound: "c5ma",
      },
      {
        note: note5,
        sound: "c5sma",
      },
      {
        note: note6,
        sound: "c5pa",
      },
      {
        note: note7,
        sound: "c5sdha",
      },
      {
        note: note8,
        sound: "c5dha",
      },
      {
        note: note9,
        sound: "c5sni",
      },
      {
        note: note10,
        sound: "c5ni",
      },
      {
        note: note11,
        sound: "c5sa",
      },
      {
        note: note12,
        sound: "c5sra",
      },
    ],
  },
  {
    cord_6: [
      {
        note: note1,
        sound: "c6ra",
      },
      {
        note: note2,
        sound: "c6sga",
      },
      {
        note: note3,
        sound: "c6ga",
      },
      {
        note: note4,
        sound: "c6ma",
      },
      {
        note: note5,
        sound: "c6sma",
      },
      {
        note: note6,
        sound: "c6pa",
      },
      {
        note: note7,
        sound: "c6sdha",
      },
      {
        note: note8,
        sound: "c6dha",
      },
      {
        note: note9,
        sound: "c6sni",
      },
      {
        note: note10,
        sound: "c6ni",
      },
      {
        note: note11,
        sound: "c6sa",
      },
      {
        note: note12,
        sound: "c6sra",
      },
    ],
  },
];

let pianoTemp = () => {
  return `
    <div class="cord c1">
      <div class="switch note ra">
        <span class="cord-title">C1</span>
        <div class="switch semi-note-left soft-ga">
        </div>
      </div>
      <div class="switch note ga">
        <div class="switch semi-note-right ma">
        </div>
      </div>
      <div class="switch note sharp-ma"></div>
      <div class="switch note pa">
        <div class="switch semi-note-left soft-dha">
        </div>
      </div>
      <div class="switch note dha">
        <div class="switch semi-note-middle soft-ni"></div>
      </div>
      <div class="switch note ni">
        <div class="switch semi-note-right sa"></div>
      </div>
      <div class="switch note soft-ra"></div>
    </div>
  `;
};

let allCorsTem = "";

// create note
configNote.forEach((data, i) => {
  allCorsTem += `
    <div class="cord c${i + 1}">
        <div class="switch note ${
          data["cord_" + (i + 1)][0].note
        }" data-cIndex="${i}" data-sound="0">
          <span class="cord-title">C${i + 1}</span>
          <div class="switch semi-note-left ${
            data["cord_" + (i + 1)][1].note
          }" data-cIndex="${i}" data-sound="1">
          </div>
        </div>
        <div class="switch note ${
          data["cord_" + (i + 1)][2].note
        }" data-cIndex="${i}" data-sound="2">
          <div class="switch semi-note-right ${
            data["cord_" + (i + 1)][3].note
          }" data-cIndex="${i}" data-sound="3">
          </div>
        </div>
        <div class="switch note ${
          data["cord_" + (i + 1)][4].note
        }" data-cIndex="${i}" data-sound="4"></div>
        <div class="switch note ${
          data["cord_" + (i + 1)][5].note
        }" data-cIndex="${i}" data-sound="5">
          <div class="switch semi-note-left ${
            data["cord_" + (i + 1)][6].note
          }" data-cIndex="${i}" data-sound="6">
          </div>
        </div>
        <div class="switch note ${
          data["cord_" + (i + 1)][7].note
        }" data-cIndex="${i}" data-sound="7">
          <div class="switch semi-note-middle ${
            data["cord_" + (i + 1)][8].note
          }" data-cIndex="${i}" data-sound="8"></div>
        </div>
        <div class="switch note ${
          data["cord_" + (i + 1)][9].note
        }" data-cIndex="${i}" data-sound="9">
          <div class="switch semi-note-right ${
            data["cord_" + (i + 1)][10].note
          }" data-cIndex="${i}" data-sound="10"></div>
        </div>
        <div class="switch note ${
          data["cord_" + (i + 1)][11].note
        }" data-cIndex="${i}" data-sound="11"></div>
      </div>
  `;
});

allCord.innerHTML = allCorsTem;

let count = 0;
function makeTune(swt, tune) {
  swt.classList.add("active");
}

document.onmouseup = function () {
  initialize();
};
document.onkeyup = function () {
  initialize();
};

function initialize() {
  console.log("s");
  // count = 0;
  let activeSwitch = document.querySelectorAll(".switch.active");
  activeSwitch?.forEach((el) => {
    el.classList.remove("active");
  });
}

let activeScale = +document.querySelector(".scale-change-header.active")
  .dataset["scale"];

let range;

tabContext();

anyToggle.action = ({ thisHeader }) => {
  if (thisHeader.classList.contains("scale-change-header")) {
    activeScale = thisHeader.dataset["scale"];
    tabContext();
  }
};

function tabContext() {
  range = configNote.slice(+activeScale - 2, +activeScale + 1);
  let cordDiv = document.querySelector(`.cord.c${activeScale}`);
  if (cordDiv) {
    cordDiv.scrollIntoView({ behavior: "smooth", block: "center" });
  }
}

window.addEventListener("keydown", (e) => {
  e.preventDefault();
  range.forEach((cordBlock, i) => {
    let cord = document.querySelector(`.cord.c${+activeScale + (i - 1)}`);
    cordBlock[`cord_${activeScale - 1 + i}`]?.forEach((key, j) => {
      if (e.key == keyFlow[i][j][key.note]) {
        cord?.querySelector("." + key.note)?.mousedown();
      }
    });
  });
});

window.addEventListener("mousedown", (e) => {
  if (e.target.closest(".switch")) {
    let note = e.target.closest(".switch");
    let index = +note.dataset["cindex"];
    let soundIndex = +note.dataset["sound"];
    let sound = configNote[index]["cord_" + (index + 1)][soundIndex].sound
    makeTune(note, sound);
  }
});
